<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ethereum Time Capsule - Create Your Digital Legacy</title>
  <link rel="stylesheet" href="styles.css">
  <script type="text/javascript" src="matomo.js"></script>
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="container">
      <h1 class="logo">üï∞Ô∏è Ethereum Time Capsule</h1>
      <div class="wallet-section">
        <div id="wallet-status" class="wallet-status">‚ùå Wallet Not Connected</div>
        <button id="connect-wallet-btn" class="btn-secondary">Connect Wallet</button>
      </div>
    </div>
  </header>

  <!-- Progress Indicator -->
  <div class="progress-container">
    <div class="container">
      <div class="progress-steps">
        <div class="progress-step active" data-step="1">
          <div class="step-number">1</div>
          <div class="step-label">Fill Entry</div>
        </div>
        <div class="progress-step" data-step="2">
          <div class="step-number">2</div>
          <div class="step-label">Preview</div>
        </div>
        <div class="progress-step" data-step="3">
          <div class="step-number">3</div>
          <div class="step-label">Encrypt</div>
        </div>
        <div class="progress-step" data-step="4">
          <div class="step-number">4</div>
          <div class="step-label">Submit</div>
        </div>
        <div class="progress-step" data-step="5">
          <div class="step-number">5</div>
          <div class="step-label">Complete</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <main class="main">
    <div class="container">

      <!-- Step 1: Fill Your Entry -->
      <div id="step-1" class="step">
        <div class="step-header">
          <h2>Fill Your Entry</h2>
          <p>Create your message for the future. All information will be encrypted and stored on the blockchain.</p>
        </div>

        <form id="capsule-form" class="capsule-form">
          <div class="form-group">
            <label for="entry-title">Your Name</label>
            <input type="text" id="entry-title" placeholder="Enter your name..." maxlength="100" required>
          </div>

          <div class="form-group">
            <label for="entry-tags">Title of Your Entry</label>
            <input type="text" id="entry-tags" placeholder="What is this entry about?" maxlength="200" required>
          </div>

          <div class="form-group">
            <label for="entry-story">Your Message</label>
            <textarea id="entry-story" rows="8" placeholder="Write your message to the future..." required></textarea>
          </div>

          <div class="form-group">
            <label for="entry-image">Upload an Image</label>
            <input type="file" id="entry-image" accept="image/*" required>
            <small>JPG, PNG, GIF up to 10MB</small>
          </div>

          <div class="form-actions">
            <button type="button" id="step1-next-btn" class="btn-primary">Preview Your Entry</button>
          </div>
        </form>
      </div>

      <!-- Step 2: Preview Your Entry -->
      <div id="step-2" class="step" style="display: none;">
        <div class="step-header">
          <h2>Preview Your Entry</h2>
          <p>Review your entry before encryption. You can still go back and make changes.</p>
        </div>

        <div class="preview-card">
          <div class="preview-image-container">
            <img id="preview-image" src="" alt="Preview image" class="preview-image">
          </div>
          <div class="preview-content">
            <h3 id="preview-title" class="preview-title"></h3>
            <div class="preview-tags">
              <span class="tag" id="preview-tags"></span>
            </div>
            <div class="preview-story">
              <p id="preview-story"></p>
            </div>
          </div>
        </div>

        <div class="encryption-info">
          <h4>üîí Encryption Details</h4>
          <ul>
            <li>Your message will be encrypted using Shutter Network</li>
            <li>The decryption key will be released in less than 60 seconds</li>
            <li>If the process seems stuck, cancel the transaction from your wallet and start over</li>
            <li>What you will, again, more about Shutter Network</li>
          </ul>
        </div>

        <div class="form-actions">
          <button type="button" id="step2-back-btn" class="btn-secondary">Edit Entry</button>
          <button type="button" id="step2-confirm-btn" class="btn-primary">Connect your wallet and encrypt</button>
        </div>
      </div>

      <!-- Step 3: Encryption -->
      <div id="step-3" class="step" style="display: none;">
        <div class="step-header">
          <h2>Encryption</h2>
          <p>Your entry is being encrypted and prepared for submission to the blockchain.</p>
        </div>

        <div class="process-container">
          <div class="process-section">
            <h3>üîê Encrypting Your Data</h3>
            <div class="progress-bar">
              <div id="encryption-progress" class="progress-fill"></div>
            </div>
            <div id="encryption-status" class="status-text">Ready to start encryption...</div>
            <button id="encrypt-btn" class="btn-primary">Start Encryption</button>
          </div>

          <div class="process-section">
            <h3>‚õìÔ∏è Submit to Blockchain</h3>
            <div class="progress-bar">
              <div id="chain-progress" class="progress-fill"></div>
            </div>
            <div id="chain-status" class="status-text">Waiting for encryption to complete...</div>
            <button id="submit-to-chain-btn" class="btn-primary" disabled>Submit to Chain</button>
          </div>
        </div>

        <div class="form-actions">
          <button type="button" id="step3-back-btn" class="btn-secondary">Back to Preview</button>
        </div>
      </div>      <!-- Step 4: Submission Progress -->
      <div id="step-4" class="step" style="display: none;">
        <div class="step-header">
          <h2>Submitting to Blockchain</h2>
          <p>Your encrypted capsule is being submitted to the Ethereum blockchain.</p>
        </div>

        <div class="process-container">
          <div class="process-section">
            <h3>‚õìÔ∏è Blockchain Submission</h3>
            <div class="progress-bar">
              <div id="chain-progress" class="progress-fill"></div>
            </div>
            <div id="chain-status" class="status-text">Preparing transaction...</div>
          </div>
        </div>

        <div class="submission-progress">
          <div class="progress-animation">
            <div class="spinner"></div>
          </div>
          <div class="submission-status">
            <p id="submission-message">Please confirm the transaction in your wallet...</p>
          </div>
        </div>
      </div>

      <!-- Step 5: Completion -->
      <div id="step-5" class="step" style="display: none;">
        <div class="step-header">
          <h2>My Amazing Entry to the Ethereum Time Capsule</h2>
          <p>Your time capsule has been successfully created and stored on the blockchain!</p>
        </div>

        <div class="completion-card">
          <div class="completion-image">
            <img id="final-preview-image" src="" alt="Pixelated preview" class="pixelated-preview">
          </div>

          <div class="completion-details">
            <h3 id="final-title" class="capsule-title"></h3>

            <div class="capsule-info">
              <div class="info-item">
                <span class="info-label">Capsule ID:</span>
                <span id="final-capsule-id" class="info-value"></span>
              </div>
              <div class="info-item">
                <span class="info-label">Transaction:</span>
                <span id="final-tx-hash" class="info-value hash"></span>
              </div>
              <div class="info-item">
                <span class="info-label">Unlocks on:</span>
                <span id="final-reveal-time" class="info-value"></span>
              </div>
            </div>
          </div>
        </div>

        <div class="share-section">
          <h4>Share Your Time Capsule</h4>
          <div class="share-url-container">
            <input type="text" id="share-url" readonly class="share-url-input">
            <button id="copy-url-btn" class="btn-secondary">Copy Link</button>
          </div>

          <div class="share-buttons">
            <button id="share-twitter-btn" class="btn-social twitter">Share on X</button>
          </div>
        </div>

        <div class="final-actions">
          <button id="create-another-btn" class="btn-primary">Encrypt Another Entry</button>
          <button id="view-all-btn" class="btn-secondary">See Your Entry in the Gallery</button>
        </div>
      </div>

    </div>
  </main>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <p>&copy; 2025 Ethereum Time Capsule. Built with ‚ù§Ô∏è for the future.</p>
    </div>
  </footer>  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/@walletconnect/web3-provider@1.8.0/dist/umd/index.min.js"></script>

  <!-- BLST WASM runtime (required for custom shutter crypto) -->
  <script src="https://cdn.jsdelivr.net/npm/@shutter-network/blst@0.1.7/dist/blst.min.js"></script>

  <!-- Custom Shutter WASM loader and app logic -->
  <script src="blst.js"></script>
  <script type="module" src="main.js"></script>
  <script type="module" src="app.js"></script>
</body>
</html>
